(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=e(n);fetch(n.href,s)}})();class O{canvas;emitter;state=new Map;x=0;y=0;constructor(t,e){this.canvas=t,this.emitter=e}onKeyDown=t=>{this.state.set(t.code,!0),t.key===" "&&this.emitter.emit("space")};onKeyUp=t=>{this.state.set(t.code,!1)};onMouseMove=t=>{const e=this.canvas.getBoundingClientRect();this.x=t.clientX-e.left,this.y=t.clientY-e.top};onMouseDown=t=>{t.button===0?this.emitter.emit("leftClick"):t.button===2&&this.emitter.emit("rightClick")};onContextMenu=t=>{t.preventDefault()};init(){window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp),window.addEventListener("mousedown",this.onMouseDown),window.addEventListener("contextmenu",this.onContextMenu),this.canvas.addEventListener("mousemove",this.onMouseMove)}dispose(){window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp),window.removeEventListener("mousedown",this.onMouseDown),window.removeEventListener("contextmenu",this.onContextMenu),this.canvas.removeEventListener("mousemove",this.onMouseMove)}}class z{listeners={};on(t,e){return this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e),()=>{this.off(t,e)}}emit(t,...e){if(this.listeners[t])for(const i of this.listeners[t])i(...e)}off(t,e){this.listeners[t]&&(this.listeners[t]=this.listeners[t].filter(i=>i!==e))}}class r{x;y;constructor(t,e){this.x=t,this.y=e}static radian(t){return new r(Math.sin(t),Math.cos(t)).normalize()}static random(){return new r(Math.random()*2-1,Math.random()*2-1).normalize()}equal(t){return this.x===t.x&&this.y===t.y}empty(){return this.equal(new r(0,0))}add(t){return new r(this.x+t.x,this.y+t.y)}sub(t){return new r(this.x-t.x,this.y-t.y)}dot(t){return this.x*t.x+this.y*t.y}dist(t){const e=this.sub(t);return Math.sqrt(e.x**2+e.y**2)}cross(t){return this.x*t.y-this.y*t.x}scale(t){return new r(this.x*t,this.y*t)}length(){return Math.hypot(this.x,this.y)}normalize(){const t=this.length();return t===0?new r(0,0):this.scale(1/t)}perpendicular(){return new r(-this.y,this.x)}negate(){return new r(-this.x,-this.y)}clone(){return new r(this.x,this.y)}rotate(t){const e=Math.cos(t),i=Math.sin(t);return new r(this.x*e-this.y*i,this.x*i+this.y*e)}}class I{position;width;height;speed;hp;direction;game;constructor(t){this.position=t.position,this.width=t.width,this.height=t.height,this.speed=t.speed,this.hp=t.hp,this.game=t.game,this.direction=new r(0,0)}wouldCollide(t){const e=this.game.scene;if(!e)return!1;for(const i of e.allEntities)if(i.intersect(t,Math.max(this.width,this.height)))return!0;return!1}update(t){if(this.speed===0)return;const e=this.direction.scale(this.speed),i=this.position.add(new r(e.x,0)),n=this.position.add(new r(0,e.y)),s=this.position.add(e);if(t)if(!this.wouldCollide(s))this.position=s;else{let o=!1;this.wouldCollide(i)||(this.position=i,o=!0),this.wouldCollide(n)||(this.position=n,o=!0),o||(this.position=this.position)}else this.wouldCollide(s)||(this.position=s)}}class R{origin;direction;constructor(t,e){this.origin=t,this.direction=e.normalize()}intersect(t){const e=this.origin,i=this.direction,[n,s]=t,o=s.sub(n),l=i.cross(o);if(l===0)return null;const c=n.sub(e),d=c.cross(o)/l,x=c.cross(i)/l;return d>=0&&x>=0&&x<=1?e.add(i.scale(d)):null}reflect(t){const[e,i]=t;let s=i.sub(e).normalize().perpendicular().normalize();s.dot(this.direction)>0&&(s=s.negate());const o=this.direction.dot(s);return this.direction.sub(s.scale(2*o)).normalize()}}class T{gap;count;interval;finite;sx;sy;width;height;timer;index;finished=!1;constructor(t){this.gap=t.gap??0,this.count=t.count??1,this.interval=t.interval??1/0,this.finite=t.finite??this.count===1,this.sx=t.sx,this.sy=t.sy,this.width=t.width,this.height=t.height,this.timer=0,this.index=0}get x(){return this.sx+this.index*(this.width+this.gap)}get y(){return this.sy}reset(){this.timer=0,this.index=0,this.finished=!1}update(t){this.timer+=t,!(this.timer<this.interval||this.finished)&&(this.timer=0,this.index=this.index+1,this.index>=this.count&&(this.finite?(this.index=this.count-1,this.finished=!0):this.index=0))}}class M{resource;frames;localCanvas;localContext;hi=!1;vi=!1;rotation=0;type;frame;constructor(t,e){this.resource=t,this.frames={};for(const[n,s]of Object.entries(e))this.frames[n]=new T(s);const i=Object.keys(e)[0];this.type=i,this.frame=this.frames[i],this.localCanvas=document.createElement("canvas"),this.localCanvas.width=this.frame.width,this.localCanvas.height=this.frame.height,this.localContext=this.localCanvas.getContext("2d"),this.localContext.imageSmoothingEnabled=!1}play(t){t!==this.type&&(this.type=t,this.frame=this.frames[t],this.frame.reset())}update(t){this.frame.update(t)}rotate(t){this.rotation=Math.atan2(t.y,t.x)}draw(t,e,i,n,s){if(!this.frame)return;const o=this.frame,l=n??o.width,c=s??o.height;this.localCanvas.width=l,this.localCanvas.height=c;const d=this.localContext;d.imageSmoothingEnabled=!1,d.clearRect(0,0,l,c),d.save(),d.translate(l/2|0,c/2|0),d.rotate(this.rotation),this.hi&&this.vi?d.scale(-1,-1):this.hi?d.scale(-1,1):this.vi&&d.scale(1,-1),d.drawImage(this.resource.img,o.x,o.y,o.width,o.height,-l/2|0,-c/2|0,l,c),d.restore(),t.drawImage(this.localCanvas,e-l/2|0,i-c/2|0)}}class D{position;direction;game;speed;active=!0;sprite;bounce=0;maxBounces=1/0;constructor(t,e,i,n=4){this.position=t,this.direction=e,this.game=i,this.speed=n,this.sprite=this.game.sprites.ball,this.sprite.play("run"),this.sprite.rotate(e)}update(t){const e=this.game.scene;if(e){if(this.bounce>=this.maxBounces)return this.active=!1,!1;this.position=this.position.add(this.direction.scale(this.speed)),this.sprite.update(t),this.speed*=.9985;for(const i of e.allEntities)if(i){const n=i.intersect(this.position,12);if(n){this.bounce+=1;const s=new R(this.position,this.direction);this.direction=s.reflect(n),this.sprite.rotate(this.direction);break}}return!0}}}class q{character;sprite;game;isAttacking=!1;constructor(t,e){this.game=e,this.character=new I({position:t,width:16,height:16,speed:2.5,hp:100,game:e}),this.sprite=this.game.sprites.cat}init(){this.game.emitter.on("leftClick",this.attack),this.game.emitter.on("rightClick",this.throw)}dispose(){this.game.emitter.off("leftClick",this.attack),this.game.emitter.off("rightClick",this.throw)}attack=()=>{if(!this.isAttacking){this.sprite.play("attack"),this.isAttacking=!0;const t=this.game.scene?.rats??[];for(const e of t)this.character.position.dist(e.character.position)<30&&(e.character.hp-=25)}};throw=()=>{const t=this.game.scene;t&&(t.projectiles.length>1||t.projectiles.push(new D(this.character.position.add(this.ray.direction.scale(10)),this.ray.direction,this.game)))};update(t){const e=this.game.control;let i=new r(0,0);e.state.get("KeyW")&&(i=i.add(new r(0,-1))),e.state.get("KeyS")&&(i=i.add(new r(0,1))),e.state.get("KeyA")&&(i=i.add(new r(-1,0))),e.state.get("KeyD")&&(i=i.add(new r(1,0))),this.character.direction=i.normalize(),this.updateCharacter(t)}updateCharacter(t){const e=this.game.scene;if(!e)return;let i="idle";this.isAttacking?this.sprite.frame.finished?(this.isAttacking=!1,i=this.character.direction.empty()?"idle":"run"):i="attack":i=this.character.direction.empty()?"idle":"run",this.sprite.play(i),this.character.direction.x<0?this.sprite.hi=!0:this.character.direction.x>0&&(this.sprite.hi=!1);for(const n of e.projectiles)if(n.position.dist(this.character.position)<=Math.max(this.character.width,this.character.height)){n.speed<3&&(n.active=!1);break}this.character.update(!0),this.sprite.update(t)}draw(t){this.game.scene?._debug&&(t.fillStyle="red",t.beginPath(),t.ellipse(this.character.position.x,this.character.position.y,this.character.width,this.character.height,Math.PI/4,0,360),t.fill()),this.sprite.draw(t,this.character.position.x,this.character.position.y,this.character.width*3,this.character.height*3)}get ray(){const t=this.game.control.y,e=this.game.control.x,i=new r(e,t).sub(this.character.position).normalize();return new R(this.character.position,i)}}class B{canvas;context;frameId=-1;fps_timestamp=-1;fps_interval;scene;constructor(t){this.canvas=t,this.context=this.canvas.getContext("2d",{alpha:!1});const e=window.devicePixelRatio,i=t.getBoundingClientRect();t.width=i.width*e,t.height=i.height*e,this.context.scale(e,e),t.style.width=`${i.width}px`,t.style.height=`${i.height}px`,this.context.imageSmoothingEnabled=!1,this.fps_interval=1e3/60}tick=()=>{this.frameId=requestAnimationFrame(this.tick);const t=Date.now(),e=t-this.fps_timestamp;e<this.fps_interval||(this.fps_timestamp=t-e%this.fps_interval,this.scene&&(this.scene.update(e),this.scene.draw(this.context)))};start(){this.tick()}stop(){cancelAnimationFrame(this.frameId)}}const a=32,y=a*24,w=a*18,f=y/2,E=w/2,A=(h,t,e=100)=>{const i=h.map(m=>j(m));let n=0,s=0,o=0,l=!1,c=!1,d=0;return function(){if(l)return{done:!0,lines:i[i.length-1]};n+=.18;const m=h[s];o=Math.min(Math.floor(n),h[s].length);const S=x(i[s],o);return c&&(d+=1),o>=m.length&&!c&&(c=!0,d=0),c&&d===e&&(s++,n=0,o=0,c=!1,d=0),s>=h.length&&(l=!0),{done:l,lines:S}};function x(m,S){let b=0;const p=[];for(const v of m)if(b+v.length<S-1)p.push(v),b+=v.length;else{p.push(v.substr(0,S-b));break}return p}function j(m){const S=m.split(" "),b=[];let p="";for(const v of S)p.length+v.length+1>t?(b.push(p),p=v):p+=(p.length===0?"":" ")+v;return p&&b.push(p),b}};class L{sceneDraw;interactive;entities=[];objects2D=[];projectiles=[];rats=[];game;_debug=!1;constructor(t,e=!0){this.sceneDraw=t,this.interactive=e}*gen(){for(const t of this.entities)yield t;for(const t of this.objects2D)t.entity&&(yield t.entity)}get allEntities(){return[...this.gen()]}update(t){if(this.interactive){this.game?.player?.update(t);for(const e of this.entities)e.update(t);for(const e of this.objects2D)e.update(t);for(let e=0;e<this.projectiles.length;e++)this.projectiles[e].update(t),this.projectiles[e].active||(this.projectiles.splice(e,1),e-=1);for(let e=0;e<this.rats.length;e++)this.rats[e].update(t),this.rats[e].character.hp<=0&&(this.rats.splice(e,1),e-=1)}}draw(t){if(this.sceneDraw(t),!!this.interactive){for(const e of this.objects2D)e.draw(t),this._debug&&e.entity?.draw(t);for(const e of this.projectiles)e.sprite.draw(t,e.position.x,e.position.y,16,16);for(const e of this.rats)e.draw(t);if(this.game?.player?.draw(t),this._debug)for(const e of this.entities)e.draw(t)}}}const _=h=>{const t=A(["They say black cat brings bad luck","But today the black cat is unlucky","Once a predator, now it is just a pitiful parody","Your reputation is tarnished, the masters are displeased","Get your reputation back as a predator to stay home"],24);let e=-1;return new L(n=>{n.fillStyle="#000000",n.fillRect(0,0,y,w);const{lines:s,done:o}=t();o&&e===-1&&(e=setTimeout(()=>{h.s<1&&h.setScene(h.s+1)},2e3)),n.fillStyle="#fff",n.textBaseline="top",n.textAlign="center",n.font="24px monospace";let l=0;for(const c of s)n.fillText(c,f,E-a+l),l+=a;n.fill(),n.font="16px monospace",n.fillStyle="#4d4343",n.fillText("[Press space to skip]",f,w-a*2)},!1)};function Y(h=100){let t=0;return function(){t>h&&(t=h);const n=Math.round(t/h*255).toString(16).padStart(2,"0");return t++,`#${n}0000`}}const F=h=>{const t=A(["ACT 1","Kitchen"],24,250);let e=-1;const i=Y(800);return new L(s=>{s.fillStyle="#000000",s.fillRect(0,0,y,w);const{lines:o,done:l}=t();l&&e===-1&&(e=setTimeout(()=>{h.s<2&&h.setScene(h.s+1)},3e3)),s.fillStyle=i(),s.textBaseline="top",s.textAlign="center",s.font="24px monospace";let c=0;for(const d of o)s.fillText(d,f,E-a+c),c+=a;s.fill(),s.font="16px monospace",s.fillStyle="#4d4343",s.fillText("[Press space to skip]",f,w-a*2)},!1)};class k{position;vectors;color;constructor(t,e,i={color:"#000"}){this.position=t,this.vectors=e,this.color=i.color}static line(t,e,i){return new k(t,[e,i])}static square(t,e){const i=e/2|0;return new k(t,[new r(-i,-i),new r(i,-i),new r(i,i),new r(-i,i)])}static polygon(t,e,i="#fff"){return new k(t,e.map(([n,s])=>new r(n,s)),{color:i})}*gen(){for(let t=1;t<this.vectors.length;t++)yield[this.vectors[t-1].add(this.position),this.vectors[t].add(this.position)];yield[this.vectors[this.vectors.length-1].add(this.position),this.vectors[0].add(this.position)]}get lines(){return[...this.gen()]}rotate(t){const e=Math.atan2(t.y,t.x);for(let i=0;i<this.vectors.length;i++)this.vectors[i]=this.vectors[i].rotate(e)}move(t){this.position=this.position.add(t)}static lineIntersect(t,e,i){const[n,s]=e,o=s.sub(n),l=t.sub(n),c=o.dot(o);if(c===0)return t.sub(n).length()<=i;const d=l.dot(o)/c,x=Math.max(0,Math.min(1,d)),j=n.add(o.scale(x));return t.sub(j).length()<=i}intersect(t,e=0){for(const i of this.lines)if(k.lineIntersect(t,i,e))return i;return null}draw(t){t.beginPath(),t.setLineDash([]),t.strokeStyle=this.color,t.lineWidth=1;const e=this.vectors[0].add(this.position);t.moveTo(e.x,e.y);for(let i=0;i<this.vectors.length;i++){const n=this.vectors[i].add(this.position);t.lineTo(n.x,n.y)}t.lineTo(e.x,e.y),t.stroke()}update(t){}}class u{position;width;height;entity;sprite;frame;finite;hb;hi;vi;constructor(t,e,i,n,s,o={}){if(this.position=new r(t[0],t[1]),this.sprite=n,this.width=e,this.height=i,this.frame=s,this.hb=o.hb??!0,this.hi=o.hi??!1,this.vi=o.vi??!1,this.finite=this.sprite.frame.finite,this.hb){const l=e/2|0,c=i/2|0;this.entity=k.polygon(this.position,[[-l,-c],[l,-c],[l,c],[-l,c]],"red")}}update(t){this.finite||this.sprite.update(t)}draw(t){this.sprite.hi=this.hi,this.sprite.vi=this.vi,this.sprite.play(this.frame),this.sprite.draw(t,this.position.x,this.position.y,this.width,this.height)}}class C{game;character;counter=0;current=0;sprite;cooldown=0;cooldownCounter=0;state="run";constructor(t,e){this.game=e,this.character=new I({width:20,height:20,speed:2.8,position:t,hp:100,game:e}),this.sprite=new M(e.resources.rat,{run:{width:32,height:32,gap:0,count:10,interval:200,finite:!1,sx:2,sy:80},death:{width:32,height:32,gap:0,count:10,interval:100,finite:!0,sx:2,sy:140}}),this.character.direction=r.random(),this.state="run",this.sprite.play("run"),this.setCounter()}setCounter(){this.current=0,this.counter=150+Math.floor(Math.random()*400)}update(t){const e=this.game.scene;if(!e)return;const i=this.character.position.clone();if(this.current+=1,this.current===this.counter&&(this.character.direction=r.random(),this.setCounter()),this.state==="caught"&&(this.cooldownCounter+=1),this.cooldownCounter===this.cooldown&&(this.state="run",this.sprite.play("run")),this.state==="run"){for(this.character.update(!1);this.character.position.equal(i);)this.character.direction=r.random(),this.character.update(!1);for(const n of e.projectiles){const s=n.position.dist(this.character.position);if(this.state==="run"&&s<=16&&n.speed>2){this.state="caught",this.sprite.play("death"),this.cooldown=250,this.cooldownCounter=0,this.character.hp-=10;break}}}this.character.direction.x<0?this.sprite.hi=!1:this.character.direction.x>0&&(this.sprite.hi=!0),this.sprite.update(t)}draw(t){const e=this.character.position.x,i=this.character.position.y;this.sprite.draw(t,e,i,64,64),t.beginPath(),t.fillStyle="red",t.rect(e-10,i-32,32,4),t.fill(),t.closePath(),t.beginPath(),t.fillStyle="green",t.rect(e-10,i-32,32*(this.character.hp/100),4),t.fill(),t.closePath()}}const H=h=>{const t=a/6,e=new L(s=>{s.fillStyle="#b0b897",s.fillRect(a,a*5,700,500),s.fillStyle="#545046",s.beginPath(),s.rect(0,0,a,w),s.rect(0,0,f,a),s.rect(f,0,a,a*2),s.rect(y-a,220,y-a,w-220),s.rect(0,w-a,y,w),s.rect(f,a*2,f,a),s.rect(y-a,a*2,a,w-a*2),s.fill(),s.closePath(),s.beginPath(),s.fillStyle="#6e6244",s.rect(a,a,f-a,150),s.fill(),s.closePath(),s.beginPath(),s.fillStyle="#445216",s.rect(f,a*3,352,164),s.fill(),s.closePath(),s.beginPath(),s.fillStyle="#a6b379";for(let o=0;o<22;o++)s.rect(f+o*a/2,a*3,t,164);s.fill(),s.closePath(),s.beginPath(),s.fillStyle="#ffffff",s.rect(a,180,f-a,t),s.rect(a,180,t,E+a*2+10),s.rect(a,w-a-t,y-a*2,t),s.rect(f-t,180,t,80),s.rect(f-t,258,354,t),s.rect(y-a-t,258,t,280),s.fill(),s.closePath()}),i=h.sprites.furniture,n=!1;return e.objects2D=[new u([450,210],48,96,i,"door",{hb:n}),new u([604,180],48,96,i,"window",{hb:n}),new u([654,180],48,96,i,"window",{hb:n}),new u([174,106],61*4.5,32*4.5+3,i,"kitchen",{hb:n}),new u([346,108],74,144,i,"fridge",{hb:n}),new u([210,350],128,64,i,"table"),new u([190,380],26,40,i,"chair_ver_1"),new u([230,380],26,40,i,"chair_ver_1"),new u([580,300],128,64,i,"tv_table"),new u([580,280],128,64,i,"tv"),new u([550,420],39,39,i,"chair2"),new u([600,420],39,39,i,"chair2"),new u([54,516],24,32,i,"flowers")],e.entities=[k.polygon(new r(384,360),[[-342,-174],[-6,-174],[-6,-96],[342,-96],[342,174],[-342,174]],"red")],e.projectiles.push(new D(new r(380,290),new r(0,0),h,0)),e.projectiles.push(new D(new r(78,520),new r(0,0),h,0)),e.rats.push(new C(new r(64,400),h)),e.rats.push(new C(new r(64,400),h)),e.rats.push(new C(new r(64,400),h)),e.rats.push(new C(new r(64,400),h)),e.rats.push(new C(new r(64,400),h)),e.rats.push(new C(new r(64,400),h)),e.rats.push(new C(new r(64,400),h)),e};class W{scenes=[];resources={};sprites={};emitter=new z;control;renderer;player;s=0;constructor(t){this.renderer=new B(t),this.control=new O(t,this.emitter)}load(){return Promise.all(Object.values(this.resources).map(t=>t.load()))}get scene(){const t=this.scenes[this.s];if(!t)throw new Error;return t}init(){return this.player=new q(new r(300,300),this),this.player.init(),this.control.init(),this.scenes=[_(this),F(this),H(this)],this.setScene(this.s),this.emitter.on("space",()=>{const t=this.scene;t&&(t.interactive||this.setScene(this.s+1))}),Promise.resolve()}setScene(t){this.s=t,this.scene.game=this,this.renderer.scene=this.scene}}class P{source;loaded=!1;img;constructor(t){this.source=t,this.img=new Image}get width(){return this.img.width}get height(){return this.img.height}load(){return new Promise((t,e)=>{this.img.onload=()=>{this.loaded=!0,t()},this.img.onerror=i=>{e(i)},this.img.src=this.source})}}const K=document.getElementById("app");if(!K)throw new Error;const g=new W(K);g.resources={furniture:new P("public/sprites/furniture.png"),interior:new P("public/sprites/interior.png"),cat:new P("public/sprites/cat.png"),ball:new P("public/sprites/ball.png"),rat:new P("public/sprites/rat.png")};g.sprites={furniture:new M(g.resources.furniture,{table:{width:32,height:16,sx:0,sy:17},sofa:{width:32,height:16,sx:34,sy:85},fridge:{width:16,height:32,sx:204,sy:290},kitchen:{width:61,height:32,sx:442,sy:119},chair_hor:{width:11,height:15,sx:2,sy:35},chair_ver_1:{width:10,height:15,sx:3,sy:52},chair_ver_2:{width:10,height:15,sx:20,sy:52},door:{width:16,height:32,sx:340,sy:120},window:{width:16,height:32,sx:17,sy:69},tv:{width:32,height:16,sx:153,sy:85},tv_table:{width:32,height:14,sx:306,sy:70},chair2:{width:13,height:13,sx:307,sy:172},flowers:{width:8,height:12,sx:123,sy:21}}),interior:new M(g.resources.interior,{corner:{width:8,height:8,sx:27,sy:100},wall:{width:8,height:8,sx:9,sy:0},wall2:{width:8,height:8,sx:18,sy:0},floor:{width:8,height:8,sx:0,sy:9}}),cat:new M(g.resources.cat,{idle:{width:16,height:16,gap:0,count:4,interval:250,finite:!1,sx:0,sy:4},run:{width:16,height:16,gap:0,count:4,interval:200,finite:!1,sx:0,sy:36},attack:{width:16,height:16,gap:0,count:4,interval:100,finite:!0,sx:0,sy:84},death:{width:16,height:16,gap:0,count:4,interval:250,finite:!0,sx:0,sy:212}}),ball:new M(g.resources.ball,{run:{width:32,height:32,gap:0,count:4,interval:200,finite:!1,sx:0,sy:0}}),rat:new M(g.resources.rat,{run:{width:32,height:32,gap:0,count:8,interval:200,finite:!1,sx:2,sy:103}})};g.load().then(()=>g.init()).then(()=>g.renderer.start());
